%%  Start by opening TCP connection with RANA.
pause on
clear;clc;

portnr = 11999;
t = tcpip('localhost', portnr,'TimeOut',1);
fopen(t);

%%  Talk with the server
dataFromRana = sentToRana(t, 't1,1')
%%
tmp = "t1,";

for i = 1:101000
    if i == 1 
        tmp1 = strcat(tmp,"10");
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 5000
        tmp1 = strcat(tmp,"0")
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 10000
        tmp1 = strcat(tmp,"30");
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 12000
        tmp1 = strcat(tmp,"0");
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 15000
        tmp1 = strcat(tmp,"50");
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 25000
        tmp1 = strcat(tmp,"5");
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 35000
        tmp1 = strcat(tmp,"70");
        dataFromRana = sentToRana(t,tmp1);
    elseif i == 40000
        tmp1 = strcat(tmp,"10");
        dataFromRana = sentToRana(t,tmp1);
    else
        dataFromRana = sentToRana(t, 'done\n');
    end

end

%%
clc;clf;clear;
file_start = '../../test_';
file_end = '.csv';

i = 2;
while true
    filepath = strcat(file_start, num2str(i), file_end)
    if exist(filepath,'file') == 0
        break;
    end
    
    data = csvread(filepath);
    hold on
    plot(data)
    hold off
    
    i = i +1;
end

ddata = [];




hold on 
plot(ddata)
hold off
grid on















